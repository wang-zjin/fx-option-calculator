# 第六步：部署到服务器 — 详细说明

把 `npm run build` 生成的 **`dist`** 里的内容放到服务器上，让其他人能通过网址访问。

---

## 一、先确认本机已有 dist

在项目根目录执行过：

```bash
npm run build
```

成功后，项目里会有一个 **`dist`** 文件夹，里面大致是：

- `index.html`（入口页）
- `assets/` 文件夹（里面有 `.js`、`.css` 等）

**要上传的是：`dist` 里面的所有文件和文件夹**（不是把 `dist` 这个文件夹本身当作网站根目录时，就上传“dist 里的内容”）。

---

## 二、三种常见部署方式

### 方式 A：用 FTP 上传到公司/行内服务器（最常见）

**1. 准备 FTP 信息**

向运维或管理员要：

- 服务器地址（IP 或域名）
- 用户名、密码（或密钥）
- **网站根目录路径**（例如 `/var/www/html`、`/home/www`、`public_html` 等）

**2. 用 FTP 工具连接服务器**

- 装一个 FTP 客户端，例如 **FileZilla**（[https://filezilla-project.org](https://filezilla-project.org)）
- 打开 FileZilla，填：主机（服务器地址）、用户名、密码、端口（一般是 21）
- 连接成功后，右侧是“远程站点”，左侧是“本地站点”

**3. 上传 dist 里的内容**

- 左侧进入你电脑上的：  
  `外汇期权计算器/dist`  
  确保能看到 `index.html` 和 `assets` 文件夹
- 右侧进入服务器上的 **网站根目录**（就是上面要来的那个路径）
- 选中左侧 **`dist` 里的所有内容**（`index.html` 和 `assets` 等），拖到右侧
- 上传完成后，服务器网站根目录里应有 `index.html` 和 `assets/`，而不是一个叫 `dist` 的文件夹

**4. 访问网站**

浏览器打开：`http://服务器IP或域名`  
例如：`http://192.168.1.100` 或 `http://your-company.com`

若打不开，检查：服务器防火墙是否开放 80 端口、网站根目录是否指到刚上传的目录。

---

### 方式 B：用 SSH 上传到 Linux 服务器

**1. 在你自己电脑上（在项目目录下）执行：**

把下面命令里的 `用户名` 和 `服务器IP或域名` 换成你的实际信息；  
`/var/www/html` 换成服务器上的网站根目录路径。

```bash
scp -r dist/* 用户名@服务器IP或域名:/var/www/html/
```

例如：

```bash
scp -r dist/* root@192.168.1.100:/var/www/html/
```

输入服务器密码后，会把你本机 `dist` 里的所有内容上传到服务器的 `/var/www/html/`。

**2. 若服务器已有 Nginx，且网站根目录就是 `/var/www/html`**

上传后直接访问：`http://服务器IP或域名` 即可。

**3. 若刷新页面或直接访问子路径出现 404**

说明需要给单页应用（SPA）做“回退到 index.html”的配置。在服务器上编辑 Nginx 站点配置，在对应 `server` 里加上：

```nginx
location / {
  try_files $uri $uri/ /index.html;
}
```

然后执行：`nginx -t` 检查配置，再 `systemctl reload nginx`（或 `sudo nginx -s reload`）重载 Nginx。

---

### 方式 C：用 Vercel / Netlify 静态托管（免服务器）

适合没有自己的服务器、想要一个公网地址的情况。

**Vercel：**

1. 打开 [https://vercel.com](https://vercel.com)，用 GitHub/邮箱注册并登录
2. 点击 **Add New → Project**
3. 若选 **从本地上传**：
   - 安装 Vercel 命令行：`npm i -g vercel`
   - 在项目根目录执行：`vercel`，按提示登录、选择或新建项目
   - 发布目录选 **`dist`**（或按提示填）
4. 若选 **从 Git 部署**：
   - 先把项目推到 GitHub，再在 Vercel 里导入该仓库
   - 构建命令填：`npm run build`
   - 输出目录填：`dist`
5. 部署完成后会得到一个地址，如 `https://xxx.vercel.app`，分享即可访问

**Netlify：**

1. 打开 [https://netlify.com](https://netlify.com)，注册并登录
2. **Drag and drop**：把本机 **`dist` 文件夹里的全部内容** 拖到网页上的拖放区域
3. 或 **Connect to Git**：连 GitHub 仓库，构建命令 `npm run build`，发布目录 `dist`
4. 部署完成后会得到一个地址，如 `https://xxx.netlify.app`

---

## 三、部署后若“刷新就 404”

本应用是单页应用（SPA），所有路径都应由前端接管，所以服务器要把“找不到文件”的请求都指回 `index.html`。

- **Nginx**：在对应站点的 `location /` 里加：

  ```nginx
  try_files $uri $uri/ /index.html;
  ```

- **Apache**：在网站根目录放 `.htaccess`，内容可为：

  ```apache
  <IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /
    RewriteRule ^index\.html$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.html [L]
  </IfModule>
  ```

- **Vercel / Netlify**：一般默认就支持 SPA，无需额外配置。

---

## 四、小结

| 你有啥           | 推荐做法                         |
|------------------|----------------------------------|
| 公司/行内服务器  | 用 FTP 或 SSH 把 **dist 里的内容** 上传到网站根目录 |
| 自己的 Linux 机  | 用 `scp -r dist/* 用户@服务器:网站根目录`，并配置 Nginx try_files |
| 没有服务器       | 用 Vercel 或 Netlify 上传 dist 或连 Git 部署     |

核心一点：**服务器上网站根目录里，要有 `index.html` 和 `assets/` 等（即 dist 里的内容），别人访问你的域名或 IP 才能打开外汇期权计算器。**
