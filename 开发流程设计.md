# 外汇期权计算器 — 开发流程设计

## 项目概述

- **阶段一**：Web UI 界面（先做可用的网页版）
- **阶段二**：打包为手机 App（复用阶段一逻辑与部分 UI）

**功能范围**：Vanilla（欧式香草）、数字期权、美式期权、亚式期权及后续奇异期权（障碍、回望等）的定价。详见 **[功能规格-期权类型与定价.md](./功能规格-期权类型与定价.md)**。

---

## 阶段一：Web UI 界面

### 1. 需求与范围确认

| 步骤 | 内容 | 产出 |
|------|------|------|
| 1.1 | **期权类型**：Vanilla（欧式看涨/看跌）、数字期权、美式期权、亚式期权、后续奇异期权；输入：即期、执行价、到期、利率、波动率等 | 功能清单 |
| 1.2 | **定价模型**：Garman-Kohlhagen（Vanilla/数字）、二叉树/三叉树（美式）、蒙特卡洛/解析近似（亚式）、按类型扩展奇异期权 | 模型选型文档 |
| 1.3 | **输出**：期权价格、Greeks（Vanilla/数字解析；美式/亚式数值）；亚式可选标准误/置信区间 | 输出规格 |

### 2. 技术选型

| 项目 | 建议 | 说明 |
|------|------|------|
| 前端框架 | React / Vue / 纯 HTML+JS | 便于阶段二用 React Native / 小程序等复用逻辑 |
| 样式 | CSS / Tailwind / 组件库 | 先保证桌面端体验，再考虑响应式 |
| 计算逻辑 | 独立 JS/TS 模块 | 与 UI 解耦，方便在 Web 和 App 中共用 |
| 构建工具 | Vite / Create React App | 快速开发、易部署 |

### 3. 开发步骤（阶段一）

```
步骤 A：项目初始化
├── 创建前端项目（如 Vite + React）
├── 配置代码规范（ESLint/Prettier）
├── 设计目录结构（components / utils / hooks / pages）
└── 如需要，预留 API 目录（后续对接行情/波动率）

步骤 B：核心计算模块（按功能规格分阶段实现）
├── 公共：正态 CDF、Garman-Kohlhagen 的 d1/d2、折现
├── Vanilla：欧式看涨/看跌定价 + Greeks（Garman-Kohlhagen）
├── 数字期权：Cash-or-Nothing 解析定价（及可选 Greeks）
├── 美式期权：二叉树/三叉树定价（看跌必做，看涨可复用欧式）
├── 亚式期权：蒙特卡洛或解析近似（均价看涨/看跌）
├── 单元测试（Jest/Vitest）保证各类型计算正确性
└── 与 UI 解耦，便于阶段二复用

步骤 C：Web UI 开发
├── 输入区：期权类型选择（Vanilla/数字/美式/亚式）、即期、执行价、到期、利率、波动率；按类型展示额外参数（如数字支付额、树步数、亚式平均方式）
├── 结果区：期权价格、Greeks（按类型显示）、亚式可选标准误
├── 交互：实时计算 or 点击「计算」按钮
├── 响应式布局（为后续移动端浏览做准备）
└── 错误提示与输入校验

步骤 D：联调与优化
├── 用已知案例验证定价与 Greeks
├── 性能与体验优化
├── 部署到内网或静态托管（如 Nginx / Vercel）
├── 编写简单的使用说明
└── **Debug 机制**：出现问题将「现象 + 解决方案」记录到 [Issues/](./Issues/README.md)，便于复用与 AI 检索（参见 Issues/README.md）
```

### 4. 阶段一交付物

- 可访问的 Web 页面：支持 **Vanilla、数字、美式、亚式** 期权定价与相应 Greeks/数值结果
- 核心计算逻辑的独立模块（按期权类型分模块）+ 单元测试
- 简要技术说明与部署方式

---

## 阶段二：手机 App

### 5. 技术路线选择

| 方案 | 优点 | 缺点 | 适用场景 |
|------|------|------|----------|
| **React Native** | 与 React Web 共享逻辑与部分组件 | 需学 RN 生态与原生配置 | 希望一套逻辑多端复用 |
| **Uni-app / Taro** | 一套代码多端（H5 + 微信/支付宝小程序 + App） | 与现有 Web 技术栈可能不同 | 需要小程序 + App |
| **Capacitor / Cordova** | 用现有 Web 项目「套壳」成 App | 本质是 WebView，体验略逊原生 | 快速出 App、以展示为主 |
| **Flutter** | 性能与体验好 | 需用 Dart 重写，无法直接复用 JS 计算模块 | 追求原生级体验、可接受重写 |

**推荐**：若阶段一用 **React**，阶段二优先考虑 **React Native**（计算逻辑用 JS/TS 直接复用）或 **Capacitor**（把现有 Web 打包成 App，速度最快）。

### 6. 开发步骤（阶段二）

```
步骤 A：选定方案与环境
├── 确定：React Native / Capacitor / Uni-app 等
├── 搭建开发环境（Android Studio / Xcode / 对应 CLI）
└── 创建新项目或引入「套壳」配置

步骤 B：复用与迁移
├── 将阶段一的「计算逻辑」以 npm 包或源码形式接入 App 项目
├── 复用或重写 UI 组件（RN 组件 / 小程序组件 / WebView 内页面）
├── 适配小屏：布局、字体、触控区域、安全区
└── 统一输入校验与错误提示

步骤 C：App 专属能力
├── 图标、启动页、应用名称
├── 如需：推送、本地存储、权限（如通知）
├── 打包：Android APK/AAB、iOS IPA
└── 内部分发或上架应用商店（按行内流程）

步骤 D：测试与发布
├── 真机测试（Android / iOS）
├── 与 Web 版对比：结果一致、体验可接受
└── 按行内规范做安全与合规检查
```

### 7. 阶段二交付物

- 可安装的 Android / iOS 应用（或先做一端）
- 与 Web 版一致的计算结果
- 安装包与简要使用说明

---

## 整体时间线示意

```
阶段一（Web）
├── 需求与选型     —— 约 1 周
├── 计算模块       —— 约 2–3 周（Vanilla → 数字 → 美式 → 亚式，含测试）
├── Web UI         —— 约 2–3 周
└── 联调与部署     —— 约 1 周

阶段二（App）
├── 方案与环境     —— 约 1 周
├── 复用与 UI 适配 —— 约 2–3 周
├── App 能力与打包 —— 约 1–2 周
└── 测试与发布     —— 约 1 周
```

---

## 关键成功因素

1. **计算逻辑与 UI 分离**：阶段一就做成独立模块，阶段二直接复用，避免重复实现与不一致。
2. **先 Web 后 App**：在浏览器里快速迭代产品与公式，再考虑移动端体验与打包。
3. **用标准案例验证**：用教材或彭博/Reuters 上的示例数据校验价格和 Greeks，再推广使用。
4. **安全与合规**：涉及行内使用或客户数据时，提前与科技/合规确认部署方式与数据范围。

如果你愿意，下一步可以从「阶段一步骤 A：项目初始化」或「核心计算模块接口设计」开始，我可以按你当前技术栈给出具体命令和代码结构。
